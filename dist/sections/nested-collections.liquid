<div class="NestedCollection margin-bottom-10x s-margin-bottom-4x">
  <div class="NestedCollection__banner">
    <picture>
      <source media="(max-width: 799px)" srcset="{{section.settings.hero_image_mobile | img_url:'master'}}">
      <source media="(min-width: 800px)" srcset="{{section.settings.hero_image | img_url:'master'}}">
      <img
        src="{{section.settings.hero_image | img_url:'master'}}"
        alt="{{section.settings.hero_image.alt}}"
        alt="{{section.settings.hero_image.alt}}"
      >
    </picture>   
    <div class="NestedCollection__header">
      <h1 class="NestedCollection__heading">{{collection.title}}</h1>
      <p class="NestedCollection__description">{{collection.description}}</p> 
    </div>
    <picture>
      <source media="(max-width: 799px)" srcset="{{section.settings.hero_image_mobile_2 | img_url:'master'}}">
      <source media="(min-width: 800px)" srcset="{{section.settings.hero_image_2 | img_url:'master'}}">
      <img
        src="{{section.settings.hero_image_2 | img_url:'master'}}"
        alt="{{section.settings.hero_image_2.alt}}"
        alt="{{section.settings.hero_image_2.alt}}"
      >
    </picture>
  </div>


  
  <div class="container l">
    <div class="row ">
  <div class="NestedCollection__filter-container js-filterContainer column l3 s12">
    <div class="BorderBottom flex h-space-between">
      {% include 'collection-nested-filter' %}
    </div>
  </div>
  

  <div class="column l9 s12 NestedCollection__product-side">
  {% for block in section.blocks %}
    {% if block.type =="collection" %}
    {% assign collection = collections[block.settings.collection] %}
    {% if block.settings.image %}{% assign hasImage = true %}{% else %}{% assign hasImage = false %}{% endif %}
    <div class="NestedCollection__container js-nestedContainer row" data-style="{{collection.title}}">
      <div class="NestedCollection__collection NestedCollection__grid">
        <div class="row NestedCollection__grid-cell NestedCollection__grid-cell-info js-collectionInfo" data-style="{{collection.title}}">
          <div class="NestedCollection__collection__info">
            <div class="NestedCollection__collection__heading-container">
            {% if collection.image %}
              <picture>
                <source media="(max-width: 600px)" srcset="{{block.settings.image | img_url:'master'}}">
                <img class="NestedCollection__collection__image" src="{{collection.image | img_url:'master'}}" alt="{{collection.featured_image.alt}}">
              </picture>
              <div class="NestedCollection__collection__title-container">
                <h2 class="NestedCollection__collection__title h1 Link--partial-accent">{{collection.title}}</h2>
                <p class="NestedCollection__collection__body">{{collection.description}}</p>
              </div>
              {% endif %}

            </div>
          </div>
        </div>
        <div class="row NestedCollection__row">
        {% for product in collection.products %}
          <div id="Product-{{product.id}}" class="NestedCollection__grid-cell NestedCollection__grid-cell-product js-collectionProduct">
            {% include 'collection-product' %}
          </div>
        {% endfor %}
        </div>

        </div>
    </div>

    {% elsif block.type == "featured_collection" %}
    {% assign collection = collections[block.settings.collection_2] %}
    {% if block.settings.image %}{% assign hasImage = true %}{% else %}{% assign hasImage = false %}{% endif %}
    <div class="NestedCollection__container js-nestedContainer-2 row" data-style="{{collection.title}}">
      <div class="NestedCollection__collection NestedCollection__grid">
        <div class="row NestedCollection__grid-cell NestedCollection__grid-cell-info js-collectionInfo-2" data-style="{{collection.title}}">
          <div class="NestedCollection__collection__info">
            <div class="NestedCollection__collection__heading-container">
            {% if collection.image %}
              <picture>
                <source media="(max-width: 600px)" srcset="{{block.settings.image | img_url:'master'}}">
                <img class="NestedCollection__collection__image" src="{{collection.image | img_url:'master'}}" alt="{{collection.featured_image.alt}}">
              </picture>
              <div class="NestedCollection__collection__title-container">
                <h2 class="NestedCollection__collection__title h1 Link--partial-accent">{{collection.title}}</h2>
                <p class="NestedCollection__collection__body">{{collection.description}}</p>
              </div>
              {% endif %}

            </div>
          </div>
        </div>
        <div class="row NestedCollection__row">
        {% for product in collection.products %}
          <div id="Product-{{product.id}}" class="NestedCollection__grid-cell NestedCollection__grid-cell-product js-collectionProduct">
            {% include 'collection-product' %}
          </div>
        {% endfor %}
        </div>
      </div>
    </div>     

    {% elsif block.type == "sub_collection" %}
    {% assign collection = collections[block.settings.collection_3] %}
    {% if block.settings.image %}{% assign hasImage = true %}{% else %}{% assign hasImage = false %}{% endif %}
    <div class="NestedCollection__container js-nestedContainer-2 row" data-style="{{collection.title}}">
      <div class="NestedCollection__collection NestedCollection__grid">
        <div class="row NestedCollection__grid-cell NestedCollection__grid-cell-info js-collectionInfo-2" data-style="{{collection.title}}">
          <div class="NestedCollection__collection__info">
            <div class="NestedCollection__collection__heading-container">
            {% if collection.image %}
              <picture>
                <source media="(max-width: 600px)" srcset="{{block.settings.image_3 | img_url:'master'}}">
                <img class="NestedCollection__collection__image" src="{{collection.image | img_url:'master'}}" alt="{{collection.featured_image.alt}}">
              </picture>
              <div class="NestedCollection__collection__title-container">
                <h2 class="NestedCollection__collection__title h1 Link--partial-accent">{{collection.title}}</h2>
                <p class="NestedCollection__collection__body">{{collection.description}}</p>
              </div>
              {% endif %}

            </div>
          </div>
        </div>
        <div class="row NestedCollection__row">
        {% for product in collection.products %}
          <div id="Product-{{product.id}}" class="NestedCollection__grid-cell NestedCollection__grid-cell-product js-collectionProduct">
            {% include 'collection-product' %}
          </div>
        {% endfor %}
        </div>
      </div>
    </div>     



    {% endif %}   
  {% endfor %}
  </div>
  </div>
</div>
</div>


{% include 'collection-nested-filter-script' %}
{% schema %}
{
  "name": "Nested Collection",
  "settings":[
    {
      "id": "hero_image",
      "type": "image_picker",
      "label": "Left Desktop Image"
    },
    {
      "id": "hero_image_wide",
      "type": "image_picker",
      "label": "Left Wide Desktop Image(>1800px)"
    },
    {
      "id": "hero_image_mobile",
      "type": "image_picker",
      "label": "Left Mobile Image"
    },
    {
      "id": "hero_image_2",
      "type": "image_picker",
      "label": "Right Desktop Image"
    },
    {
      "id": "hero_image_wide_2",
      "type": "image_picker",
      "label": "Right Wide Desktop Image(>1800px)"
    },
    {
      "id": "hero_image_mobile_2",
      "type": "image_picker",
      "label": "Right Mobile Image"
    }
  ],
  "blocks":[
    {
      "type":"collection",
      "name":"Category",
      "settings": [
        {
          "type":"collection",
          "id":"collection",
          "label":"Collection"
        },
        {
          "id": "image",
          "type": "image_picker",
          "label": "Image"
        }
      ]
    },
    {
      "type":"featured_collection",
      "name":"Featured Collection",
      "settings": [
        {
          "type":"collection",
          "id":"collection_2",
          "label":"Collection"
        },
        {
          "id": "image_2",
          "type": "image_picker",
          "label": "Image"
        }
      ]      
    },
    {
      "type":"sub_collection",
      "name":"Collection",
      "settings": [
        {
          "type":"collection",
          "id":"collection_3",
          "label":"Collection"
        },
        {
          "id": "image_3",
          "type": "image_picker",
          "label": "Image"
        }
      ]      
    }
  ]
}
{% endschema %}